<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Getting Started With The TravelPort Universal API</title>
  <meta name="GENERATOR" content="Blackfriday Markdown Processor v1.1" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="css/base.css" />
</head>
<body>

<h1>Getting Started With The TravelPort Universal API</h1>

<h3>Unit 1, Lesson 1</h3>

<h3>WSDL</h3>

<p>Although these lessons are using Java, the lessons&rsquo; concepts apply to pretty much any programming language.  The <em>interface</em> to the Universal API (uAPI) is defined with <a href="http://en.wikipedia.org/wiki/Web_Services_Description_Language">WSDL</a> or Web Services Definition Language, pronounced &ldquo;whiz-dul&rdquo;.  This means that any programming language that knows how to &ldquo;use web services&rdquo; can access the APIs and get useful things done.  In practice, this means that you need a <em>generator</em> that can take a file &ldquo;foo.wsdl&rdquo; and spit out &ldquo;foo_client.java&rdquo;, or whatever, in your favorite language.  Different generators have slightly different behaviors (of course, WSDL is a &ldquo;standard!&rdquo;); we&rsquo;ll be using <a href="http://cxf.apache.org/">Apache&rsquo;s CXF</a> to work with the uAPI in Java.  (&ldquo;CXF&rdquo; is not really an acronym in this case but is related to the project&rsquo;s origin.)</p>

<h3>Downloading the tutorial code</h3>

<p>You can download the tutorial code using github to clone the repository. You can use your favorite <a href="https://git.wiki.kernel.org/articles/i/n/t/Interfaces,_frontends,_and_tools.html">git tool</a> or just use the command line like this:</p>

<pre><code class="bash">&gt; mkdir learn-tport
&gt; cd learn-tport
&gt; git clone git@github.com:iansmith/travelport-uapi-tutorial.git

</code></pre>

<p>This last command will create the directory <code>travelport-uapi-tutorial</code> and within that directory you will find the a few files that we will discuss later, plus the directories <code>src</code> and <code>wsdl</code>.  If you explore the <code>wsdl</code> directory, you&rsquo;ll see many WSDL files as well as a number of <a href="http://en.wikipedia.org/wiki/XSD">XML schemas</a>, as <code>xsd</code> files.  All of these files have been supplied by TravelPort and can be downloaded as version 2.1.0.1 of the uAPI from <a href="http://developer.travelport.com">their developer site</a> as well.</p>

<h3>Apache CXF</h3>

<p>Apache&rsquo;s CXF is the critical &ldquo;glue&rdquo; for connecting TravelPort&rsquo;s web services to our tutorial code.  (There are plenty of other choices for interacting with web services in Java, but CXF is just a very popular one.)  You&rsquo;ll need to <a href="http://cxf.apache.org/download.html">download and install</a> the Apache CXF code; this tutorial expects you to be using at least version 2.6.0.  If you are using <a href="http://www.eclipse.org">Eclipse</a> like most Java developers, you can install the CXF directly into Eclipse by going to &ldquo;Preferences &gt; WebServices&rdquo;.  (If you don&rsquo;t have this preference option, you&rsquo;ll need to install the <a href="http://www.eclipse.org/webtools/">Web Tools Platform</a>, or WTP, for Eclipse.)  The preferences screen where you add your installation of CXF should look something like this (with the preference choice highlight by the red box).</p>

<p><br/>
<img src="images/preferences.png"/>
<br/></p>

<p>If you are not using eclipse, you&rsquo;ll need to be sure that the CXF jar files are <a href="http://docs.oracle.com/javase/tutorial/essential/environment/paths.html">in your classpath</a> and that you can run the command &lsquo;cxf&rsquo; from the command line.  Be aware that there many java libraries that are &ldquo;subsumed&rdquo; by CXF, so you&rsquo;ll end up with about 75 libraries in your classpath!</p>

<h3>Generating A Java Version Of The API</h3>

<p>We need to generate java code from the WSDL and XSD files supplied by Travelport&rsquo;s uAPI.  Let&rsquo;s start by generating the Java code for the &ldquo;System&rdquo; service.  In eclipse, you can do this by selecting the WSDL file <code>System.wsdl</code> in the directory <code>wsdl/system_v8_0</code> and then using the context-menu in eclipse to choose &ldquo;Generate Client&rdquo;, as is shown here:</p>

<p><br/>
<img src="images/generate-client-menu.png"/>
<br/></p>

<p>When you select that option in eclipse, you&rsquo;ll be presented with a sequence of three dialog boxes connected by hitting the <code>Next</code> button.  The vast majority of these options are really not of much interest to us for this tutorial, but to show you exactly the options to choose you can verify your configuration against this set as these screenshots:</p>

<p><br/>
<img src="images/generate-client-dialog1.png"/>
<br/>
<img src="images/generate-client-dialog2.png"/>
<br/>
<img src="images/generate-client-dialog3.png"/>
<br/></p>

<p>On the first screenshot in this sequence, the red box indicates a slider.  This slider can be moved to another position if you are the type of person who doesn&rsquo;t like having &ldquo;errors&rdquo; on your screen.  The last dialog box in the sequence shows that there are number of checkbox selected that control the generation of the Java code.  The lower set of checkboxes that are checked (such as -Xts and -Xts:multiline) are not crucial to having the tutorial work properly, but do make debugging easier.</p>

<h4>Command Line Generation Of A Java Client</h4>

<p>If you are using the command line, you can do manually what eclipse does behind the scenes based on the values given in these dialogs. Below is a very complex command line generated by eclipse that you can start from, although you will need to adjust the paths to your local machine.</p>

<pre><code>wsdl2java -client -d /Users/iansmith/tport-workspace/uapijava/.cxftmp/src -classdir /Users/iansmith/tport-workspace/uapijava/build/classes -p http://www.travelport.com/service/system_v8_0=com.travelport.service.system_v8_0 -impl -validate -exsh true -dns true -dex true -autoNameResolution -xjc-Xts,-Xts:style:multiline,-Xlocator,-mark-generated -wsdlLocation http://localhost:8080/kestrel/ExternalCacheAccessService?wsdl -verbose -fe jaxws -db jaxb -wv 1.1 file:/Users/iansmith/tport-workspace/uapijava/wsdl/system_v8_0/System.wsdl
</code></pre>

<h3>The Java Client For &ldquo;System&rdquo;</h3>

<p>If you use the WDT viewer for a WSDL file, you will see this image when you open <code>wsdl/system_v8_0/System.wsdl</code>:</p>

<p><br/>
<img src="images/SystemService.png"/>
<br/></p>

<p>(There are tabs at the bottom of the main editor view to control whether you view this file in &ldquo;design view&rdquo; or as a normal source code file.)  This shows you that there are two &ldquo;Services&rdquo; exposed by <code>System</code> WSDL: <code>ExternalCacheAccessService</code> and <code>SystemService</code>.  The latter is the one we will be working with the rest of this lesson.  You can see the java code that has been generated for this service in your project&rsquo;s src folder the class <code>com.travelport.service.system_v8_0.SystemService</code>.  Although you are welcome to read and explore the source, the good news is that you can <em>safely ignore</em> all the implementation details about this service.  This the beauty of WSDL!</p>

<p>Referring back to the diagram for <code>SystemService</code> above, you&rsquo;ll see that there are three &ldquo;ports&rdquo; exposed by the <code>SystemService</code>: <code>SystemInfoPortType</code>, <code>SystemPingPortType</code>, and the <code>SystemTimePortType</code>.  The pattern used by the uAPI design is to expose a &ldquo;port&rdquo; which has a single method, usually we refer to the port object just by its name without the prefix or suffix such as &ldquo;the ping port.&rdquo;  The ping port&rsquo;s only method is &ldquo;service&rdquo; as you can see from the diagram; far more interesting is that the input and output parameters are of type <code>PingReq</code> and <code>PingRsp</code> for the request and response respectively.  You can find the source code for these classes in the src Java folder with a name like <code>com.travelport.schema.system_v8_0.PingReq</code>.</p>

<h3>The Programming Model</h3>

</body>
</html>
